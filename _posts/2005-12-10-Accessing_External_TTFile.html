---
category: perl
layout: post
tags: []
title: 导入 Template Toolkit 文件
---
{% include JB/setup %}

因为 <a href="http://www.template-toolkit.org">TT</a> 是个很庞大的系统，我们经常将 template 拆分为好几部分，然后在某一 .tt 文件中导入外部的文件。<br />很明显，这么做最大的目的是代码复用/ code reuse. 带来的好处还有清晰的结构。<br />我上回在<a href='template_introduction.html'>Template Toolkit 入门</a>提过 INCLUDE 和 INSERT 的区别。<br />不过导入的指示符中我忘了讲另一个很重要的 PROCESS<p />我们先用一个简单的例子解释下三者的区别。一个外部文件 ex.tt 如：<br /><pre>[% foo = 'bar' %]<br />foo = [% foo %] in External File.</pre>然后一个主文件：<br /><pre>[% foo = 'main' %]<br />foo = [% foo %] in Main<br />[% INSERT ex.tt %]<br />foo = [% foo %] in Main after insert/include/process</pre><ul>三种情况：<br /><li>如代码所显示的是 [% INSERT 时，显示的结果为：<br /><pre>foo = main in Main<br />[% foo = 'bar' %]<br />foo = [% foo %] in External File.<br />foo = main in Main after insert/include/process</pre>INSERT 的作用就是将文件原封不动的显示出来。</li><li>将 [% INSERT 改为 [% INCLUDE 后将显示：<br /><pre>foo = main in Main<br />foo = bar in External File.<br />foo = main in Main after insert/include/process</pre>INCLUDE 将外部文件执行，然后将结果返回到主文件中。</li><li>将 [% INSERT 改为 [% PROCESS 后将显示：<br /><pre>foo = main in Main<br />foo = bar in External File.<br />foo = bar in Main after insert/include/process</pre>注意与 INCLUDE 的不同。PROCESS 后 foo 在 main 中的值将变为 bar. PROCESS ex.tt 将 foo 改后会影响 main 里的值。<br />INCLUDE 是将结果返回，而 PROCESS 更类似与将这段代码返回然后在 main 中执行。</li></ul><h4>other tips</h4><ul>下面是一些你可能碰到的东西：<br /><li>不管是哪个指示符， INCLUDE 也好 PROCESS 也好。注意下面的区别：<br /><pre>[% myheader = 'my/misc/header' %]<br />[% INCLUDE   myheader  %]            # 'myheader'<br />[% INCLUDE  "myheader" %]            # 'myheader'<br />[% INCLUDE  $myheader  %]            # 'my/misc/header'<br />[% INCLUDE "$myheader" %]            # 'my/misc/header'</pre><li>如果在 main 中定义了 foo 而在 ex.tt 中没有定义 foo 的话， ex.tt 里的 foo 将采用 main 里的 foo 值。</li><li>参数传递。我们可以在 INCLUDE/PROCESS 后传递参数进去。比如：<br /><pre>foo = [% foo %] in External File.</pre><pre>[% INCLUDE ex.tt foo = '77' %]</pre>这样 ex.tt 里的 foo 值将是 77.</li><li>注意如果你在 main 里定义了一个 BLOCK 与 INCLUDE/PROCESS 里的文件名一样时，将调用 main 里的该 BLOCK 而不是外部文件。比如我们有一个外部文件叫 bar（没有后缀），而在 main.tt 里这么写的话：<br /><pre>[% INCLUDE bar %]<br />[% BLOCK bar %]<br />   foo was [% foo %]<br />[% END %]</pre>它调用的是这个 BLOCK 而不是外部文件。这就是优先级问题。</li><li>需要多个文件的话可以使用加号：<br /><pre>[% PROCESS foo + bar %]</pre><li>关于 INCLUDE_PATH 等配置选项设置可以参考：<a href='Template_Configuration.html'>Template Toolkit 的配置选项</a></li></ul>Send me mail if u have any problem. Thanks.