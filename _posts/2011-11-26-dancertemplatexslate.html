---
category: perl
layout: post
tags:
  - Perl
  - Plack
  - dancer
  - Xslate
title: Dancer::Template::Xslate
---
{% include JB/setup %}

I'm writing some toy once again with Plack and Dancer (and Mojo later).<div><br /></div><div>this time, I'm playing <a href="http://search.cpan.org/perldoc?Plack::Middleware::OAuth">Plack::Middleware::OAuth</a> and <a href="http://search.cpan.org/perldoc?Dancer::Template::Xslate">Dancer::Template::Xslate</a> a bit. the website is&nbsp;<a href="http://kindergarden.fayland.org/">http://kindergarden.fayland.org/</a>&nbsp;and I'll open source it if someone is interested. for now, it's just 'Login with ...' OAuth and nothing else. (layout is built with&nbsp;<a href="http://twitter.github.com/bootstrap/">twitter bootstrap</a>)</div><div><br /></div><div>the Dancer::Template::Xslate has some bugs and I tried to submit few commits through github to fix it. (at least it's working for me now)</div><div><br /></div><div>here is a tip to add function like&nbsp;gravatar into Xslate within Dancer.</div><div><br /></div><div>problem as <a href="http://search.cpan.org/perldoc?Text::Xslate">Text::Xslate</a> supports <b>function</b> param when -&gt;new but Dancer YAML config can't have Perl code inside. and it's very tricky or hard to fix the engine 'template' b/c we can never modify it. it has 'my $_engine;' inside code and you can't modify it at all.</div><div><br /></div><div>after a while, I find a good solution with the <b>module</b> param of the Text::Xslate. it's very neat. sample code as below:</div><div><br /></div><div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div><div># config.yml</div><div>template: xslate</div><div>engines:</div><div>&nbsp; xslate:</div><div>&nbsp; &nbsp; syntax: 'TTerse'</div><div>&nbsp; &nbsp; extension: 'tt'</div><div>&nbsp; &nbsp; header:</div><div>&nbsp; &nbsp; &nbsp; - 'layout/header.tt'</div><div>&nbsp; &nbsp; footer:</div><div>&nbsp; &nbsp; &nbsp; - 'layout/footer.tt'</div><div>&nbsp; &nbsp; module:</div><div>&nbsp; &nbsp; &nbsp; - KinderGardenX::Text::Xslate::Bridge::KinderGarden</div></div><div><br /></div><div>#&nbsp;KinderGardenX::Text::Xslate::Bridge::KinderGarden</div><div><div>package KinderGardenX::Text::Xslate::Bridge::KinderGarden;</div><div><br /></div><div>use strict;</div><div>use warnings;</div><div>use parent qw(Text::Xslate::Bridge);</div><div><br /></div><div>use Gravatar::URL;</div><div><br /></div><div>my %funtion_methods = (</div><div>&nbsp; &nbsp; gravatar_url =&gt; \&amp;gravatar_url,</div><div>);</div><div><br /></div><div>__PACKAGE__-&gt;bridge(</div><div>&nbsp; &nbsp; function =&gt; \%funtion_methods,</div><div>);</div><div><br /></div><div>1;</div></div><div><br /></div><div># template</div><div><br /></div><div><div>&nbsp; &nbsp; &lt;img src="[% gravatar_url( email =&gt; user.email, size =&gt; 30) %]" /&gt;</div><div>&nbsp; &nbsp; &lt;img src="[% gravatar_url( email =&gt; user.email, size =&gt; 50) %]" /&gt;</div><div>&nbsp; &nbsp; &lt;img src="[% gravatar_url( email =&gt; user.email) %]" /&gt;</div></div><div><br /></div></blockquote>Note there is always more than one way to do it.&nbsp;</div><div><br /></div><div>Thanks.</div>