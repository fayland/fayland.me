---
category: perl
layout: post
tags:
  - jQuery
title: jQuery and browser time zone
---
{% include JB/setup %}

generally everyone has a browser time zone.<pre><code>var timezoneOffset = -(new Date().getTimezoneOffset());</code></pre>like mime is 480.<br /><br />I want add a simple class="date" to time span, then it will add time zone automatically. (MySQL DateTime format for now. I'll use it in my Foorum)<br /><br />it's a sample html: <a href="/jQuery/dateTimeZone.html">http://www.fayland.org/jQuery/dateTimeZone.html</a><br /><br />it will convert &lt;span class='date'>2007-11-05 12:20:30&lt;/span> to 2007-11-05 20:20:30 in my browser.<pre><code>$(function() {<br />    // follows are copied from datePicker/date.js<br />    // utility method<br />    var _zeroPad = function(num) {<br />        var s = '0'+num;<br />        return s.substring(s.length-2)<br />        //return ('0'+num).substring(-2); // doesn't work on IE :(<br />    };<br />    <br />   $(".date").each(function (i) {<br />        var s = $(this).text();<br />        var f = this.id; //format<br />        if (! f) {<br />            f = 'yyyy-mm-dd hh:ii:ss';<br />        }<br />        <br />        var d = new Date(1997, 1, 1, 1, 1, 1);<br />        var iY = f.indexOf('yyyy');<br />        if (iY > -1) {<br />            d.setFullYear(Number(s.substr(iY, 4)));<br />        }<br />        var iM = f.indexOf('mm');<br />        if (iM > -1) {<br />            d.setMonth(Number(s.substr(f.indexOf('mm'), 2)) - 1);<br />        }<br />        d.setDate(Number(s.substr(f.indexOf('dd'), 2)));    <br />        d.setHours(Number(s.substr(f.indexOf('hh'), 2)));<br />        d.setMinutes(Number(s.substr(f.indexOf('ii'), 2)));<br />        d.setSeconds(Number(s.substr(f.indexOf('ss'), 2)));<br />        <br />        var timezoneOffset = -(new Date().getTimezoneOffset());<br />        d.setMinutes(d.getMinutes() + timezoneOffset);<br /><br />        var t = f<br />            .split('yyyy').join(d.getFullYear())<br />            .split('mm').join(_zeroPad(d.getMonth()+1))<br />            .split('dd').join(_zeroPad(d.getDate()))<br />            .split('hh').join(_zeroPad(d.getHours()))<br />            .split('ii').join(_zeroPad(d.getMinutes()))<br />            .split('ss').join(_zeroPad(d.getSeconds()))<br />            ;<br />        <br />        $(this).text(t);<br />   } );<br />});</code></pre><br /><br />Enjoy!