---
category: perl
layout: post
tags:
  - KinderGarden
  - Plack
title: Plack::Middleware::FileWrap
---
{% include JB/setup %}

<div>When you really go coding, you'll meet lots of issues. then you'll write solution for them. that's straight.</div><div><br /></div><div>Today I have another CPAN module <a href="http://search.cpan.org/dist/Plack-Middleware-FileWrap/">Plack::Middleware::FileWrap</a> out to fit my demand: I'll have lots of plain HTML files, they'll share the same header/footer and I don't want to use stupid iframe.</div><div><br /></div><div>under Plack, it just means wrap $res-&gt;[2] with file content or strings.&nbsp;</div><div><br /></div><div>so here comes Plack::Middleware::FileWrap, very simple if you looked at the <a href="https://github.com/fayland/Plack-Middleware-FileWrap/blob/master/lib/Plack/Middleware/FileWrap.pm">source code</a>.</div><div><br /></div><div>then I used it in the KinderGarden project, with snippets:</div><div><br /></div><div>&nbsp; &nbsp; mount '/static/docs/' =&gt; builder {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; enable 'FileWrap', headers =&gt; ["$root/static/docs/header.html"], footers =&gt; ["$root/static/docs/footer.html"];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; Plack::App::File-&gt;new( root =&gt; "$root/static/docs" )-&gt;to_app;</div><div>&nbsp; &nbsp; },</div><div>&nbsp; &nbsp;&nbsp;</div><div>Live demo as <a href="http://kindergarden.fayland.org/static/docs/TestLocally.html">http://kindergarden.fayland.org/static/docs/TestLocally.html</a></div><div><br /></div><div>now all the files under static/docs will wrapped with header.html and footer.html (header.html/footer.html itself too!)</div><div><br /></div><div>for some advanced example, like if you just want to apply to html files, then you can code something like:</div><div><br /></div><div>&nbsp; &nbsp; mount '/static/docs/' =&gt; builder {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; enable_if { $_[0]-&gt;{PATH_INFO} =~ /\.html/ } 'FileWrap',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers =&gt; ["$root/static/docs/header.html"], footers =&gt; ["$root/static/docs/footer.html"];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; Plack::App::File-&gt;new( root =&gt; "$root/static/docs" )-&gt;to_app;</div><div>&nbsp; &nbsp; },</div><div>&nbsp; &nbsp;&nbsp;</div><div>I didn't put the Content-Type check b/c I think it's better to be handled with enable_if.</div><div><br /></div><div>Enjoy. Thanks</div>